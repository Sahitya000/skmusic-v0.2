<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>SK Music - Saavn Player</title>
  <style>
    body {
      font-family: Arial;
      background-color: #121212;
      color: white;
      padding: 20px;
    }
    input, button {
      padding: 10px;
      margin: 10px 0;
      width: 100%;
      font-size: 16px;
    }
    .song {
      margin-bottom: 20px;
      padding: 10px;
      background: #1e1e1e;
      border-radius: 10px;
    }
    audio {
      width: 100%;
      margin-top: 10px;
    }
  </style>
</head>
<body>

  <h2>üéµ Search Songs from JioSaavn</h2>
  <input type="text" id="searchBox" placeholder="Type song name..." />
  <button onclick="searchSongs()">Search</button>

  <div id="results"></div>

  <script>
async function searchSongs() {
  const query = document.getElementById("searchBox").value;
  const results = document.getElementById("results");
  results.innerHTML = "üîç Searching...";

  try {
    const res = await fetch(`https://saavn.dev/api/search/songs?query=${encodeURIComponent(query)}`);
    const data = await res.json();
    results.innerHTML = "";

    if (!data?.data?.results?.length) {
      results.innerHTML = "‚ùå No songs found.";
      return;
    }

    for (const song of data.data.results) {
      try {
        const songDetailsRes = await fetch(`https://saavn.dev/api/songs/${song.id}`);
        const songDetails = await songDetailsRes.json();
        const songData = songDetails.data[0];

        const audioURL = songData.downloadUrl?.[4]?.link || songData.downloadUrl?.[0]?.link;

        if (!audioURL) continue; // Skip if no playable URL

        const div = document.createElement("div");
        div.className = "song";
        div.innerHTML = `
          <strong>${song.name}</strong><br>
          <em>${song.primaryArtists || "Unknown Artist"}</em><br>
          <audio controls src="${audioURL}"></audio>
        `;
        results.appendChild(div);
      } catch (err) {
        console.warn("Song error skipped:", song.name);
      }
    }

  } catch (e) {
    results.innerHTML = "‚ö†Ô∏è Error fetching songs.";
    console.error(e);
  }
}
</script>
